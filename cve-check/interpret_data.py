import json

fname = "cve_list.json"
with open(fname) as fil:
    data = json.load(fil)

counts = {
    "Vulnerable": 0,
    "Vulnerable, fix deferred": 0,
    "Needs evaluation": 0,
    "Ignored": 0,
    "Ignoredend of kernel support, was needs-triage": 0,
    "IgnoredLoongArch only": 0,
    "Vulnerable, work in progress": 0,
}
for key, value in data.items():
    if "24.04" not in value["status"]:
        # print(f"{value['cve']:15} - not affected")
        continue
    if value["status"]["24.04"].startswith("Fixed"):
        # print(f"{value['cve']:15} - {value['status']['24.04']}")
        continue
    if value["status"]["24.04"].startswith("Not affected"):
        # print(f"{value['cve']:15} - {value['status']['24.04']}")
        continue
    if value["status"]["24.04"].startswith("Not in release"):
        # print(f"{value['cve']:15} - {value['status']['24.04']}")
        continue

    print(f"{value['cve']:15} - {value['status']['24.04']} - {value['pkg']}")
    counts[value["status"]["24.04"]] += 1

for k, v in counts.items():
    print(f"{k}: {v}")
